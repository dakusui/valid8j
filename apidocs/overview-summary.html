<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_392) on Tue Jan 02 07:58:35 JST 2024 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Overview (valid8j 1.0.3 API)</title>
<meta name="date" content="2024-01-02">
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script type="text/javascript" src="script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Overview (valid8j 1.0.3 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 class="title">valid8j 1.0.3 API</h1>
</div>
<div class="header">
<div class="subTitle">
<div class="block"><code>valid8j</code>: A modern DbC library for Java.</div>
</div>
<p>See: <a href="#overview.description">Description</a></p>
</div>
<div class="contentContainer">
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Packages table, listing packages, and an explanation">
<caption><span>Packages</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Package</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j/package-summary.html">com.github.dakusui.valid8j</a></td>
<td class="colLast">
<div class="block">This package collects entry point classes of the <code>valid8j</code> library.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/package-summary.html">com.github.dakusui.valid8j_pcond.core</a></td>
<td class="colLast">
<div class="block">A package to provide the core part of the <code>pcond</code> 's functionalities.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/fluent/package-summary.html">com.github.dakusui.valid8j_pcond.core.fluent</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/fluent/builtins/package-summary.html">com.github.dakusui.valid8j_pcond.core.fluent.builtins</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/identifieable/package-summary.html">com.github.dakusui.valid8j_pcond.core.identifieable</a></td>
<td class="colLast">
<div class="block">A package that provides a mechanism to make "identifieable" functions and predicates with at least one parameter for their creations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/printable/package-summary.html">com.github.dakusui.valid8j_pcond.core.printable</a></td>
<td class="colLast">
<div class="block">A package that provides a mechanism to make functions and predicates (lambdas) printable.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/core/refl/package-summary.html">com.github.dakusui.valid8j_pcond.core.refl</a></td>
<td class="colLast">
<div class="block">Offers a mechanism to invoke a method dynamically.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/experimentals/currying/package-summary.html">com.github.dakusui.valid8j_pcond.experimentals.currying</a></td>
<td class="colLast">
<div class="block">The <code>currying</code> package provides a mechanism to "curry" a multi-parameters function.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/experimentals/currying/context/package-summary.html">com.github.dakusui.valid8j_pcond.experimentals.currying.context</a></td>
<td class="colLast">
<div class="block">A package to provide the "Context" mechanism of the <code>pcond</code> library.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/experimentals/currying/multi/package-summary.html">com.github.dakusui.valid8j_pcond.experimentals.currying.multi</a></td>
<td class="colLast">
<div class="block">A package to handle "multi-parameters" function.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/experimentals/cursor/package-summary.html">com.github.dakusui.valid8j_pcond.experimentals.cursor</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/fluent/package-summary.html">com.github.dakusui.valid8j_pcond.fluent</a></td>
<td class="colLast">
<div class="block">A package to provide entry-point classes for the <code>Fluent</code> style.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/forms/package-summary.html">com.github.dakusui.valid8j_pcond.forms</a></td>
<td class="colLast">
<div class="block">This package stores entry-point classes to <code>static import</code> for your conveniences.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/internals/package-summary.html">com.github.dakusui.valid8j_pcond.internals</a></td>
<td class="colLast">
<div class="block">A package to place utility classes internally used by the <code>pcond</code> library.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/validator/package-summary.html">com.github.dakusui.valid8j_pcond.validator</a></td>
<td class="colLast">
<div class="block"><div id="toc" class="toc">
<div id="toctitle">Table of Contents
<ul class="sectlevel1">
<a href="./com/github/dakusui/valid8j_pcond/validator/#evaluator-mechanism">Evaluator Mechanism</a>
<a href="./com/github/dakusui/valid8j_pcond/validator/#message-formatting-mechanism">Message Formatting Mechanism</a>
<a href="./com/github/dakusui/valid8j_pcond/validator/#report-format">Report Format</a>
<ul class="sectlevel2">
<a href="./com/github/dakusui/valid8j_pcond/validator/#summary-format">Summary Format</a>
<a href="./com/github/dakusui/valid8j_pcond/validator/#ExplanationFormat">Explanation Format</a>
<a href="./com/github/dakusui/valid8j_pcond/validator/#Limitations">Limitations</a>




<h2 id="evaluator-mechanism">Evaluator Mechanism</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/github/dakusui/valid8j_pcond/validator/exceptions/package-summary.html">com.github.dakusui.valid8j_pcond.validator.exceptions</a></td>
<td class="colLast">
<div class="block">A package to store exception classes thrown when a condition passed to assertion/validation method of <code>pcond</code> is not satisfied.</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="contentContainer"><a name="overview.description">
<!--   -->
</a>
<div class="block"><h1><code>valid8j</code>: A modern DbC library for Java.</h1>
<div id="preamble">
<div class="sectionbody">
<p>The <code>valid8j</code> is a DbC (design by contract) programming supporting library for Java intended to be a successor of <code>valid4j</code>.
You can also replace Guava&#8217;s <code>Preconditions</code> class, Apache Common&#8217;s <code>Validate</code> class, and test assertion libraries with this.</p>
</div>
</div>
<h2 id="design-goals">Design Goals</h2>
<div class="sectionbody">
<p>Following is a list of goals that the <code>pcond</code> library tries to achieve.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Unified Support for Value Check, DbC, Test Assertion programming:</strong>  Input/status value checking, user input validation, Checks in Design by Contract, and test assertions have similar concerns, however, completely different solutions are provided <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.
The <code>pcond</code> tries to offer a unified solution to those use cases.</p>
</li>
<li>
<p><strong>More Programmer-Friendly Readability and Writability:</strong> Test assertion libraries have more and more focused on writability of code from readability of code and output.
The <code>pcond</code> makes one step further by addressing remaining pain points.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Easy to handle custom types:</strong> Test assertion libraries require users to implement custom value verifier (<code>Matcher</code> in Hamcrest, <code>Assert</code> in AssertJ, <code>Subject</code> in Google Truth) classes.
This is a significant work by itself, and it may also impede refactorings of the software under test.</p>
</li>
<li>
<p><strong>Remove repeating the same fact twice in the failure message and the predicate:</strong> More or less similar to Google Guava&#8217;s <code>Preconditions</code> class, a human needs to describe the condition to be checked twice.
One is in a natural language to print what condition is violated.
And the other is in Java programming language to define what check should be done for a given value.
This is a practice that violates "D-R-Y" (Don&#8217;t repeat yourself) principle.
This is more important for programmers than printing a nice message on a failure.</p>
</li>
<li>
<p><strong>Remove fail&#8594;fix&#8594;run loop:</strong> In the earliest age of JUnit, there used not to be a good way to verify multiple conditions in one test method.
Programmers needed to call <code>assert</code>, <code>assertEquals</code>, etc. multiple times from inside one test method.
This was causing a situation, where they need to repeat fail&#8594;fix&#8594;run&#8594;fail&#8594;fix&#8594;run&#8230;&#8203; loop, once an assert method call fails.
Ensuring a good way to write a test method with only a single assertion method call is important.</p>
</li>
<li>
<p><strong>Not having to go back-and-force between source code and output:</strong> When a check fails, making a full description of the failure available is important.
Otherwise, you will need to go back-and-forth between the code and the log (or test report).</p>
</li>
<li>
<p><strong>Human-analyzable output:</strong> A readable message is essential to understand what happened when a check fails.
However, the <code>pcond</code> interprets it in a slightly different way from other existing assertion libraries.
It focuses more on making a failure report self-sufficient and structured.
Rather than making it look "natural" as if it were written by a human, it focuses on make it readable for <strong>programmers</strong>.
Not for general English-speaking human.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Make custom verifiers composable:</strong> Instead of let a user define a custom verifier for every type, <code>pcond</code> offers a way to compose a verifier for a user type from already provided functions and predicates.</p>
</li>
<li>
<p><strong>Configurable:</strong> There are customization points for a general purpose library like <code>pcond</code>.
For instance a failure report format, an exception type for a combination of a certain context and a certain use case, A message template for a failure, etc.
Providing a good way to customize these configurations at runtime is important.</p>
</li>
</ul>
</div>
</div>
<h2 id="design">Design</h2>
<div class="sectionbody">
<p>To achieve the goals, the <code>pcond</code> library equips the following mechanisms.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Predicates and function for value checking:</strong> Instead of custom verifier classes like <code>Matcher</code>, <code>Assert</code>, or <code>Subject</code>, use conventional`Function` and <code>Predicate</code> so that it can be used not only for test assertions but also for DbC, general value checking, etc.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Transform and Check mechanism:</strong> Decompose a verification process into two steps: "Transform" function and "Check" predicate.</p>
</li>
<li>
<p><strong><code>Printable</code> mechanism:</strong> Make functions and predicates "printable".</p>
</li>
<li>
<p><strong><code>Identifiable</code> mechanism:</strong> It&#8217;s preferable to be able to "identify" two predicates are equal, if they are meant to be the same.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>Context</code> and <code>Currying</code> mechanism:</strong> Sometimes we need to handle functions and predicates that have more than one parameter.
The <code>Context</code> and <code>Currying</code> are designed for such functions.</p>
</li>
<li>
<p><strong>"Fluent" style support mechanism:</strong> Nowadays, "fluent" style is more and more preferred in test assertions.
<code>pcond</code> also supports the style.</p>
</li>
<li>
<p><strong>Configurable <code>ValueChecker</code> mechanism:</strong> To use the library with various testing frameworks, <code>pcond</code> has a configurable mechanism called <code>ValueChecker</code>.
You can configure it for your own testing framework.
It supports JUnit4 and JUnit5 out-of-box.</p>
</li>
</ul>
</div>
<h3 id="transform-and-check">"Transform and Check"</h3>
<p>The most fundamental idea of the <code>pcond</code> library is to use <code>Predicate</code> s, not special classes like <code>Matcher</code> s (Hamcrest), <code>AbstractAssert</code> (AssertJ), or <code>Subject</code> (Google Truth).</p>
<p>A basis of the design of the <code>pcond</code> library is an observation that we almost always can convert a given value into a type, which is convenient for verification, and then we can do the final verification.</p>
<p>For instance, if we have a custom typed value, we can convert it to a string, for which we can think of a lot of ways to verify if the value matches our expectation and to report how it didn&#8217;t match the expectation.</p>
<p>In the step one, we transform a value into a type for which we have a method to verify it.
Then we will check it with the intended method.</p>
<div class="imageblock text-center">
<div class="content">
<img src="data:image/png;base64," alt="diag 7121b2a03252c003bc7b8be5cc37cae1" width="840" height="266">
</div>
<div class="title">Figure 1. Value Verification in a Test</div>
</div>
<p>"Convenient" types for verification <code>pcond</code> chose are <code>Object</code>, <code>String</code>, <code>List</code>, and numbers (<code>int</code>, <code>long</code>, <code>double</code>, &#8230;&#8203;), as of now.</p>
<p>This entire step \$q\$ can be considered one <code>Predicate</code> for a value of type <code>T</code>.
\$p\$ is a predicate for verification of a convenient type value.
\$f\$ is a function to transform a given value to a convenient type.</p>
<div class="stemblock text-center">
<div class="content">
\$q(v) = p(f(v))\$
</div>
</div>
<p>For \$p\$, we only need to support a limited number of predicates because, programmers will always convert a given value into some handy types.
So, we don&#8217;t need to come up with a nicely readable messages for every method you define in your custom matchers.
Instead, the <code>pcond</code> library composes it from the transformation function \$f\$ and \$p\$ 's string representations.</p>
<p>Following is a small example code, which examines if a given value <code>yourName</code> satisfies required conditions.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ExampleDbC</span> {
 <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
   <span class="predefined-type">System</span>.out.println(hello(<span class="string"><span class="delimiter">&quot;</span><span class="content">JohnDoe</span><span class="delimiter">&quot;</span></span>));
 }

 <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> hello(<span class="predefined-type">String</span> yourName) {
   // <b class="conum">(2)</b>
   requireArgument(yourName, and(isNotNull(),
                                 transform(length()).check(gt(<span class="integer">0</span>)),
                                 containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)));
   <span class="predefined-type">String</span> ret = <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, %s</span><span class="delimiter">&quot;</span></span>, NameUtils.firstNameOf(yourName));
   // <b class="conum">(3)</b>
   <span class="keyword">return</span> ensureNonNull(ret);
 }
}</code></pre>
</div>
</div>
<p>This prints the following output.</p>
<div class="listingblock">
<div class="content">
<pre>Exception in thread "main" java.lang.IllegalArgumentException: value:&lt;"JohnDoe"&gt; violated precondition:value (isNotNull&amp;&amp;length &gt;[0]&amp;&amp;containsString[" "])
"JohnDoe"-&gt;&amp;&amp;                   -&gt;false
            isNotNull          -&gt;true
            transform
              length           -&gt;7
7        -&gt;  check
              &gt;[0]             -&gt;true
"JohnDoe"-&gt;  containsString[" "]-&gt;false</pre>
</div>
</div>
<p>It might not be 100% natural English text, but still very easily understandable for programmers.
The author of the library believes it is  more useful and reliable for developers.</p>
<h3 id="printable-mechanism"><code>Printable</code> mechanism</h3>
<p>To implement library like above, it&#8217;s necessary to format a predicate into a human-understandable format.
Unfortunately, it is not sufficient and not straight forward to override the <code>toString</code> method.
Because:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the "transform and check" style requires <code>Function</code> s, not only <code>Predicate</code> s.</p>
</li>
<li>
<p>It is not possible to override <code>toString</code> method in an interface.</p>
</li>
<li>
<p><code>Predicate</code> and <code>Function</code> interfaces have a few methods that return a newly created <code>Predicate</code> and <code>Function</code> (<code>Predicate#and</code>, <code>Function#compose</code>, for instances ).
These returned objects also need to have overridden version of <code>toString</code>.</p>
</li>
<li>
<p>Overriding <code>toString</code> is a cumbersome manual task.</p>
</li>
</ol>
</div>
<p>The <code>pcond</code> library provides a solution to these problems by offering its own base classes for <code>Predicate</code> and <code>Function</code>.</p>
<p>The implementation of this feature is provided by the <a href="com/github/dakusui/pcond/core/printable/package-summary.html"><code>com.github.dakusui.pcond.core.printable</code></a> package.</p>
<h3 id="identifiable-mechanism"><code>Identifiable</code> mechanism</h3>
<p>The <code>pcond</code> has a mechanism to create a "parameterized" predicate, such as <code>Predicates.containsString(String)</code>.
If you call this method twice, two different predicate objects are returned.
However, should those return make <code>Objects.equals(Object,Object)</code> return <code>false</code>?</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">Example</span>{
 <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span>... args) {
   <span class="predefined-type">Predicate</span>&lt;<span class="predefined-type">String</span>&gt; p1 = Predicates.containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>);
   <span class="predefined-type">Predicate</span>&lt;<span class="predefined-type">String</span>&gt; p2 = Predicates.containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>);
   <span class="predefined-type">System</span>.out.println(p1.equals(p2));
 }
}</code></pre>
</div>
</div>
<p><code>pcond</code> is designed to return <code>true</code> for this check.</p>
<p>The implementation of this feature is provided by the <a href="com/github/dakusui/pcond/core/identifieable/package-summary.html"><code>com.github.dakusui.pcond.core.identifieable</code></a> package.</p>
</div>
<h2 id="entry-points">Entry points</h2>
<div class="sectionbody">
<p>The package <a href="com/github/dakusui/pcond/package-summary.html:"><code>com.github.dakusui.pcond</code></a> holds entry point classes of the <code>pcond</code> library.</p>
<h3 id="test-assertion-library">(Test) Assertion Library</h3>
<p>The other usage of the <code>pcond</code> library is an assertion library.
It supports two styles.
One is traditional "Hamcrest" like style and the other is more recently fashioned "fluent" style like AssertJ or Google Truth.</p>
<h4 id="hamcrest-style">Hamcrest Style</h4>
<p>Hamcrest [<a href="#hamcrest">2</a>] is the first popular assertion library.
The style JUnit itself presented at the time Hamcrest was published is to call <code>assertEquals</code>, <code>assertTrue</code>, <code>assertFalse</code> methods.
Those methods fail if the given value do not satisfy the desired condition.
Also, they print human-readable message about what happened. That is, what the given value was and what was expected.</p>
<p>This approach leads to an explosion of the number of <code>assertXyz</code> methods because we need to verify values with a lot of different expectations and, for each of them, this approach requires one <code>assertXyz</code> method.</p>
<p>Hamcrest separated an assertion into two parts, one of which controls a value checking flow and the other is the part that defines a condition to be satisfied.</p>
<p>Following is an example found in Hamcrest&#8217;s tutorial[<a href="#hamcrest-tutorial">3</a>]:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.MatcherAssert.assertThat</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.Matchers</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">BiscuitTest</span> {
 <span class="annotation">@Test</span>
 <span class="directive">public</span> <span class="type">void</span> testEquals() {
   Biscuit theBiscuit = <span class="keyword">new</span> Biscuit(<span class="string"><span class="delimiter">&quot;</span><span class="content">Ginger</span><span class="delimiter">&quot;</span></span>);
   Biscuit myBiscuit = <span class="keyword">new</span> Biscuit(<span class="string"><span class="delimiter">&quot;</span><span class="content">Ginger</span><span class="delimiter">&quot;</span></span>);
   assertThat(theBiscuit, equalTo(myBiscuit)); <span class="comment">// The Line</span>
 }
}</code></pre>
</div>
</div>
<p>The object returned by a static method <code>Matchers.equalTo</code> is a <code>Matcher</code> object as other static methods in the class do.
The example verifies if <code>theBuiscuit</code> is <code>equalTo</code> <code>myBiscuit</code> as it says.</p>
<p>Suppose if <code>myBiscuit</code> is <code>Sugar</code> and this test fails, the following message will be printed:</p>
<div class="listingblock">
<div class="content">
<pre>java.lang.AssertionError:
Expected: &lt;Sugar&gt;
    but: was &lt;Ginger&gt;
Expected :&lt;Sugar&gt;
Actual   :&lt;Ginger&gt;</pre>
</div>
</div>
<p>If we want to test a different expectation, for instance, suppose we want to check if the value is not equal when a different object is given to be compared.
We can modify the test as follows at The Line:</p>
<div class="listingblock">
<div class="content">
<pre>   assertThat(theBiscuit, not(equalTo(myBiscuit))); // The Line</pre>
</div>
</div>
<p>Thus, with Hamcrest, you can construct various conditions from (relatively) limited number of <code>Matcher</code> classes.
Now you can write a human-readable test which prints a human-readable failure report.</p>
<p>However, there are still two remaining pain points:</p>
<div class="ulist">
<ul>
<li>
<p>To test your own class, you will need to implement a custom matcher class for better readability.
This is not a straight forward task.</p>
</li>
<li>
<p>Hamcrest was designed and published at the age where Java 8 did not exist, which introduced lambda and <code>Predicate</code>.
Neither using a matcher as a predicate nor the other way around is not straight forward, although it will be convenient if it is possible.</p>
</li>
</ul>
</div>
<p>The approach <code>pcond</code> took is as follows.</p>
<div class="ulist">
<ul>
<li>
<p>Introduce the "Transform-and-check" concept to uniform the check.
This will allow us to support our own class just by writing a printable function to convert the object to already fixed types.</p>
</li>
<li>
<p>Use Java&#8217;s out-of-box <code>Predicate</code> and <code>Function</code> for that.</p>
</li>
</ul>
</div>
<p>Following is the simplest example of <code>pcond</code> style test.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UTExample</span> {
 <span class="annotation">@Test</span>
 <span class="directive">public</span> <span class="type">void</span> shouldPass_testFirstNameOf() {
   <span class="predefined-type">String</span> firstName = NameUtils.firstNameOf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Yoshihiko Naito</span><span class="delimiter">&quot;</span></span>);
   assertThat(firstName, allOf(not(containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)), startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">Y</span><span class="delimiter">&quot;</span></span>)));
 }
}</code></pre>
</div>
</div>
<p><code>and</code>, <code>not</code>, <code>containsString</code>, and <code>startsWith</code> are just predicates of Java.
If you want to do a custom check, you can write your own predicate, as usual programming.
If you watn to check your custom class, you can write your own function, which converts your custom value to well-known types such as <code>String</code>, <code>Number</code>, <code>Boolean</code>, <code>List</code> of them, etc., as usual programming.
If the <code>NameUtils.firstNameOf</code> returns an empty string, it will print the following error message.</p>
<div class="listingblock">
<div class="content">
<pre>org.junit.ComparisonFailure: Value:"" violated: (!containsString[" "]&amp;&amp;startsWith["R"])
 ""-&gt;&amp;&amp;                     -&gt;true |""-&gt;&amp;&amp;                     -&gt;false
       !                    -&gt;true |      !                    -&gt;true
         containsString[" "]-&gt;false|        containsString[" "]-&gt;false
X      startsWith["Y"]      -&gt;true |      startsWith["Y"]      -&gt;false</pre>
</div>
</div>
<p>For an equivalent test, what Hamcrest prints as an error report is:</p>
<div class="listingblock">
<div class="content">
<pre>java.lang.AssertionError:
Expected: (not a string containing " " and a string starting with "R")
    but: a string starting with "R" was ""</pre>
</div>
</div>
<p>As you see, <code>pcond</code> gives more informative report.
It shows each predicate&#8217;s expected actual predicate one by one and with a modern IDE, those will be shown side-by-side.
You will notice the only last predicate <code>startsWith["Y"]</code> was not satisfied by the value <code>""</code> and that&#8217;s why the test failed.</p>
<p>While you will need to analyze which part of the <code>Expected</code> was not satisfied by the input value <code>""</code> and how by yourself from the Hamcrest&#8217;s report.</p>
<h4 id="fluent-style-experimental">Fluent Style (Experimental)</h4>
<p>The next challenge assertion libraries faced was the explosion of the static methods to be imported.
There is a bunch of static methods to be imported and classes to which they belong.
Hamcrest itself has twenty-four matcher classes, each of for which entry point class is necessary.
On top of that, there is a bunch of third party libraries.</p>
<p>What the author of AssertJ or Google Truth thought is to let programmers create a builder object first by a static method and then from the object, let programmers choose the next method to call using "fluent" style.</p>
<p>Following is the example for the usage of AssertJ based testing code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">AssertJExample</span> {
 <span class="directive">public</span> <span class="type">void</span> assertJexample() {
   <span class="comment">// AsssertJ example from:</span>
   <span class="comment">// - https://assertj.github.io/doc/#overview-what-is-assertj</span>
   <span class="comment">// in the examples below fellowshipOfTheRing is a List&lt;TolkienCharacter&gt;</span>
   assertThat(fellowshipOfTheRing).hasSize(<span class="integer">9</span>)
                                  .contains(frodo, sam)
                                  .doesNotContain(sauron);
 }
}</code></pre>
</div>
</div>
<p>Major drawback of this approach is.:</p>
<div class="ulist">
<ul>
<li>
<p>No clean way to verify multiple values.</p>
</li>
<li>
<p>Still users need to write their own assertion builder class (<code>Assert</code> in AssertJ, <code>Subject</code> in Google Truth)</p>
</li>
<li>
<p>Each builder class will need to have a number of methods.
This is because a builder just can "add" a simple check by one method.
No way to create a new one from existing ones.</p>
</li>
</ul>
</div>
<p>Adding an explanation only to the first point as the other two are more or less obvious.
When you need to do assertions for multiple values in <code>AssertJ</code>, a normal way to achieve it is following:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">AssertJMultiValueExample</span> {
 <span class="directive">public</span> <span class="type">void</span> assertjMultiValueExample() {
   <span class="comment">// https://stackoverflow.com/questions/47397525/multiply-conditions-set-in-assertj-assertions</span>
   SoftAssertions phoneBundle = <span class="keyword">new</span> SoftAssertions();
   phoneBundle.assertThat(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>).as(<span class="string"><span class="delimiter">&quot;</span><span class="content">Phone 1</span><span class="delimiter">&quot;</span></span>).isEqualTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>);
   phoneBundle.assertThat(<span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>).as(<span class="string"><span class="delimiter">&quot;</span><span class="content">Service bundle</span><span class="delimiter">&quot;</span></span>).endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>);
   phoneBundle.assertAll();
 }
}</code></pre>
</div>
</div>
<p>This is a bit verbose, and it will silently PASS, if you forget calling <code>assertAll</code> in the end.</p>
<p>An example for the <code>pcond</code> 's fluent style support looks like the following:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MoreFluentExample</span> {
 <span class="annotation">@Test</span>
 <span class="directive">public</span> <span class="type">void</span> checkTwoValues() {
   <span class="predefined-type">String</span> s = <span class="string"><span class="delimiter">&quot;</span><span class="content">HI</span><span class="delimiter">&quot;</span></span>;
   <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; strings = asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">HELLO</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">WORLD</span><span class="delimiter">&quot;</span></span>);

   assertAll(
       valueOf(s).asString()
         .exercise(TestUtils.stringToLowerCase())
         .then()
         .isEqualTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">HI</span><span class="delimiter">&quot;</span></span>),
       valueOf(strings).asListOf((<span class="predefined-type">String</span>)value())
         .then()
         .findElementsInOrder(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">world</span><span class="delimiter">&quot;</span></span>));
 }
}</code></pre>
</div>
</div>
<p>This leads to the following report.:</p>
<div class="listingblock">
<div class="content">
<pre> "HI"             -&gt;WHEN:treatAsString        -&gt;"HI"
                      stringToLowerCase       -&gt;"hi"
X"hi"             -&gt;THEN:isEqualTo["HI"]      -&gt;false
 ["HELLO","WORLD"]-&gt;WHEN:treatAsList          -&gt;["HELLO","WORLD"]
                             :
                             :
 []               -&gt;    (end)                 -&gt;true</pre>
</div>
</div>
<p>Thus, we can keep both the code and report human-readable.</p>
<h3 id="as-a-helper-library-for-design-by-contract-programming">As a Helper Library for Design by Contract programming</h3>
<p>The <code>pcond</code> can be used as a library for Design by Contract style programming in Java.
There is a couple of ways for this usage.</p>
<h4 id="with-assert-statement">With <code>assert</code> statement</h4>
<p>With this style, you can benefit the good old feature of Java: <code>assert</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Example</span> {
 <span class="directive">public</span> <span class="type">void</span> example(<span class="predefined-type">String</span> arg) {
   <span class="keyword">assert</span> precondition(arg, isNotNull().and(not(isEmpty())));
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, </span><span class="delimiter">&quot;</span></span> + arg + <span class="string"><span class="delimiter">&quot;</span><span class="content">!</span><span class="delimiter">&quot;</span></span>);
 }
}</code></pre>
</div>
</div>
<p>You will see a human-readable and analyzable output, when an assertion fails.
At the same time, once the assertion is disabled by the VM option <code>-da</code>, you will see no performance penalty for the feature.</p>
<p>Aside from the <code>precondition</code> method, <code>that</code> method is prepared for checking an invariant condition and <code>postcondition</code> method is prepared for what the name suggests.</p>
<h4 id="with-requirexyz-and-ensurexyz-methods">With <code>requireXyz</code> and <code>ensureXyz</code> methods</h4>
<p>That said, you may want to force your code to conduct a check for input value.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Example</span> {
 <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> hello(<span class="predefined-type">String</span> yourName) {
   // <b class="conum">(2)</b>
   requireArgument(yourName, and(isNotNull(), transform(length()).check(gt(<span class="integer">0</span>)), containsString(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)));
   <span class="predefined-type">String</span> ret = <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, %s</span><span class="delimiter">&quot;</span></span>, NameUtils.firstNameOf(yourName));
   // <b class="conum">(3)</b>
   <span class="keyword">return</span> ensureNonNull(ret);
 }
}</code></pre>
</div>
</div>
</div>
<h2 id="related-works">Related Works</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a id="valid4j"></a> Valid4J <a href="https://www.valid4j.org/">valid4j</a>: 2015</p>
</li>
<li>
<p><a id="hamcrest"></a> Hamcrest, Matchers that can be combined to create flexible expressions of intent <a href="https://hamcrest.org/">Hamcrest</a>: 2019</p>
</li>
<li>
<p><a id="hamcrest-tutorial"></a> Hamcrest, Hamcrest Tutorial <a href="https://hamcrest.org/JavaHamcrest/tutorial">Hamcrest Tutorial</a>: 2019</p>
</li>
<li>
<p><a id="assertj"></a> AssertJ, Fluent assertions for java <a href="https://joel-costigliola.github.io/assertj/">AssertJ</a>: 2022</p>
</li>
<li>
<p><a id="truth"></a> Truth - Fluent assertions for Java and Android Truth <a href="https://truth.dev/">Truth</a>: 2022</p>
</li>
</ul>
</div>
<p>Enjoy.</p>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Valid4J is the only example to the best knowledge of author of <code>pcond</code> library. It offers a style that unifies test assertions and DbC programming based on the Hamcrest library.
</div>
</div></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2024. All rights reserved.</small></p>
</body>
</html>
